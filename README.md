# 時系列株価予測モデル README

## プログラムの概要
このプログラムは、過去の時系列データをもとに未来の株価を予測するモデルの構築を達成するために作成されました。使用されている技術には、Python、TensorFlow、Pandas、Matplotlib などが含まれます。本プログラムは株価予測モデルの汎化の難しさを解決することを目的としており、モデルにはLSTMとTransformerを用いています。

## ノートブックへのアクセス
このリポジトリには、以下のJupyter Notebookファイルが含まれています：
- [`close_price_prediction_submission.ipynb`](./close_price_prediction_submission.ipynb) - メインの株価予測モデル（LSTM, Transformer実装）
- その他モデルの実験・改良に使用したファイル

上記リンクをクリックするか、リポジトリのファイル一覧から直接ノートブックにアクセスできます。Google Colabで開くには、ノートブックページの上部にある「Open in Colab」ボタンをクリックしてください。

## Google Colab での実行手順
以下の手順で、Google Colab 上でこのプログラムを実行できます。

### 1. Google Colab を開く
- [Google Colab](https://colab.research.google.com/)にアクセスします。
- GitHubからノートブックを開く場合は、「ファイル」→「ノートブックを開く」→「GitHub」タブを選択し、リポジトリURLを入力して該当するノートブックを選択します。
- または、ノートブックページにある「Open in Colab」ボタンを使用します。

### 2. 必要なライブラリのインストール
必要なライブラリは、ノートブック内のセルで自動的にインストールされます。特別にインストールが必要な場合は、以下のコマンドを実行してください：
```python
!pip install japanize_matplotlib
```

### 3. データの読み込み
Googleドライブにstock_price.csvファイルをアップロードしてください。
セクション２「データの確認・前処理」の第1セルで以下のコードのパスを変更してください。
```python
# データの読み込み

# マイドライブにCSVファイルをアップロードし、パスを変更してください
df = pd.read_csv('/content/drive/MyDrive/assignment-main(new)/Trainee/time-series-prediction/stock_price.csv')
df
```

### 4. ノートブックの実行
- 「ランタイム」→「すべてのセルを実行」を選択するか、各セルを順番に実行します。
- セルを個別に実行する場合は、各セル左側の実行ボタンをクリックするか、`Shift + Enter`キーを押します。

## 主な機能
- **データの前処理**: データクリーニングなど
- **EDA**: 終値の推移、STL分解、自己相関など
- **特徴量エンジニアリング**: 技術的指標（移動平均、RSI、ADXなど）の計算
- **モデル構築**: LSTMとTransformerアーキテクチャを使用した予測モデルの構築
- **モデル評価**: MSE、RMSEなどの評価指標を用いたモデルのパフォーマンス評価
- **可視化**: 予測結果と実際の株価の比較グラフなど

## モデル構成
1. **LSTM (Long Short-Term Memory) モデル**:
   - 3層のLSTMレイヤー (128, 64, 32ユニット)
   - ドロップアウト層による過学習防止
   - L2正則化による重みの調整

2. **Transformer モデル**:
   - 位置エンコーディング層
   - 複数のTransformerエンコーダーブロック
   - マルチヘッドアテンション機構

## 注意事項
- モデルの学習には数分から数十分かかる場合があります。
- GPUランタイムを使用すると処理速度が向上します（「ランタイム」→「ランタイムのタイプを変更」→「ハードウェアアクセラレータ」で「GPU」を選択）。
  
## トラブルシューティング
- メモリエラーが発生した場合: 「ランタイム」→「ランタイムを再起動」を実行し、必要に応じてバッチサイズを小さくします。
- ファイルが見つからないエラー: ファイルパスが正しいか、Google Driveに正しくファイルがアップロードされているか確認してください。
